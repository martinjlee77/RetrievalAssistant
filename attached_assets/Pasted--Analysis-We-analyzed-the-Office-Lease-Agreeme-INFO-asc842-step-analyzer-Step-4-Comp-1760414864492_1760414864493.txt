
**Analysis:**  
We analyzed the Office Lease Agreeme...
INFO:asc842.step_analyzer:‚úì Step 4: Completed in 293.4s
INFO:__main__:DEBUG: Completed step 4
INFO:shared.knowledge_base:üîç Querying asc842_leases knowledge base...
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO:shared.knowledge_base:‚úì Retrieved 8 chunks from ChromaDB (0.32s)
INFO:asc842.knowledge_search:Retrieved guidance for Step 5
INFO:asc842.step_analyzer:‚Üí Step 5: Starting analysis using gpt-5...
INFO:asc842.step_analyzer:DEBUG: Making API call to gpt-5 for Step 5
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-5, using default: 'Could not automatically map gpt-5 to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-5, using default: 'Could not automatically map gpt-5 to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-5, Input tokens: 2939, Output tokens: 2052, Cost: $0.0910
INFO:shared.api_cost_tracker:Tracked step_5_analysis request: $0.0910 (Total: $0.4941)
INFO:asc842.step_analyzer:DEBUG: Clean markdown for Step 5 (length: 8890) sample: ### Step 5: Reminders beyond initial recognition (no computations)
**Analysis:**
- Subsequent expen...
INFO:asc842.step_analyzer:‚úì Step 5: Completed in 135.7s
INFO:__main__:DEBUG: Completed step 5
INFO:asc842.step_analyzer:Extracting conclusions from 5 steps
INFO:asc842.step_analyzer:DEBUG: steps_data keys: ['step_1', 'step_2', 'step_3', 'step_4', 'step_5']
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 1: We conclude the contract contains a lease under ASC 842 because it conveys to InnovateTech the right...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 2: We conclude there is a single lease component (the right to use Suite 200) and no identifiable nonle...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 3: We conclude the office lease is an operating lease because there is no ownership transfer, no purcha...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 4: We conclude the office lease is an operating lease because none of the ASC 842-10-25-2 finance class...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 5: After initial recognition, we will recognize either a straight-line operating lease cost or separate...
INFO:asc842.step_analyzer:DEBUG: Combined conclusions length: 3174
INFO:asc842.step_analyzer:‚Üí Generating executive summary...
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-5-mini, using default: 'Could not automatically map gpt-5-mini to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-5-mini, using default: 'Could not automatically map gpt-5-mini to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-5-mini, Input tokens: 927, Output tokens: 418, Cost: $0.0022
INFO:shared.api_cost_tracker:Tracked executive_summary request: $0.0022 (Total: $0.4963)
INFO:asc842.step_analyzer:‚úì Executive summary generated (2163 chars)
INFO:asc842.step_analyzer:‚Üí Generating background section...
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-5-mini, using default: 'Could not automatically map gpt-5-mini to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-5-mini, using default: 'Could not automatically map gpt-5-mini to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-5-mini, Input tokens: 149, Output tokens: 216, Cost: $0.0008
INFO:shared.api_cost_tracker:Tracked background_generation request: $0.0008 (Total: $0.4971)
INFO:asc842.step_analyzer:‚úì Background section generated (1284 chars)
INFO:asc842.step_analyzer:‚Üí Generating final conclusion...
INFO:asc842.step_analyzer:Extracting conclusions from 5 steps
INFO:asc842.step_analyzer:DEBUG: steps_data keys: ['step_1', 'step_2', 'step_3', 'step_4', 'step_5']
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 1: We conclude the contract contains a lease under ASC 842 because it conveys to InnovateTech the right...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 2: We conclude there is a single lease component (the right to use Suite 200) and no identifiable nonle...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 3: We conclude the office lease is an operating lease because there is no ownership transfer, no purcha...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 4: We conclude the office lease is an operating lease because none of the ASC 842-10-25-2 finance class...
INFO:asc842.step_analyzer:DEBUG: Extracted conclusion for step 5: After initial recognition, we will recognize either a straight-line operating lease cost or separate...
INFO:asc842.step_analyzer:DEBUG: Combined conclusions length: 3174
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:asc842.step_analyzer:‚úì Final conclusion generated (728 chars)
INFO:asc842.clean_memo_generator:Added clean step 1 content (7877 chars)
INFO:asc842.clean_memo_generator:Added clean step 2 content (6431 chars)
INFO:asc842.clean_memo_generator:Added clean step 3 content (10088 chars)
INFO:asc842.clean_memo_generator:Added clean step 4 content (9897 chars)
INFO:asc842.clean_memo_generator:Added clean step 5 content (8890 chars)
INFO:asc842.clean_memo_generator:Clean memo generated: 55533 chars, 5/5 steps
INFO:shared.analysis_manager:üíæ Saving analysis record: 7aadbdc7
INFO:shared.analysis_manager:Current auth token is valid
ERROR:shared.analysis_manager:Database save failed - Status: 500
ERROR:shared.analysis_manager:Response headers: {'Date': 'Tue, 14 Oct 2025 04:04:45 GMT', 'Content-Type': 'application/json', 'Content-Length': '358', 'Connection': 'keep-alive', 'access-control-allow-credentials': 'true', 'access-control-allow-origin': 'http://127.0.0.1:3000', 'access-control-expose-headers': 'Authorization, Content-Type', 'Server': 'cloudflare', 'vary': 'Origin', 'x-railway-edge': 'railway/us-east4-eqdc4a', 'x-railway-request-id': 'TDmi6ASXQfyGV7lYezItjw', 'cf-cache-status': 'DYNAMIC', 'Nel': '{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}', 'Report-To': '{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=xkuhNtBvN%2BIXjyzJdXVA%2FZw7lEYJ6OHfrl61K9VPM8ptYk2uU3DdaXVNOsN3R9CtfE2Wr5AHrS2aWQSOBZ0fu9Yz1%2Fp%2FTmuVI11zKQlVr0zdUUE%3D"}]}', 'CF-RAY': '98e431c70811c96b-IAD', 'alt-svc': 'h3=":443"; ma=86400'}
ERROR:shared.analysis_manager:Response body: {"details":"UndefinedColumn: column \"error_message\" of relation \"analyses\" does not exist\nLINE 4: ...d_at, completed_at, duration_seconds, file_count, error_mess...\n                                                             ^\n","error":"Analysis billing failed","message":"The analysis could not be saved. Please contact support if this persists."}
ERROR:shared.analysis_manager:Request URL: https://www.veritaslogic.ai/api/analysis/complete
ERROR:shared.analysis_manager:Request payload: {'asc_standard': 'ASC 842', 'words_count': 586, 'api_cost': 0.49705499999999997, 'file_count': 1, 'tier_name': '3K (‚â§10 pages)', 'is_free_analysis': False, 'idempotency_key': 'manager_7aadbdc7_1760413888105', 'started_at': '2025-10-14T03:51:28.105478', 'duration_seconds': 797.0779535770416, 'success': True, 'error_message': None}
ERROR:shared.analysis_manager:Parsed error response: {'details': 'UndefinedColumn: column "error_message" of relation "analyses" does not exist\nLINE 4: ...d_at, completed_at, duration_seconds, file_count, error_mess...\n                                                             ^\n', 'error': 'Analysis billing failed', 'message': 'The analysis could not be saved. Please contact support if this persists.'}
INFO:shared.analysis_manager:ANALYSIS_EVENT: {"event_type": "complete", "timestamp": "2025-10-14T04:04:45.449649", "analysis_id": "7aadbdc7", "asc_standard": "ASC 842", "total_words": 586, "file_count": 1, "tier": "3K (\u226410 pages)", "cost": 195.0, "user_id": 7, "status": "completed", "success": true, "duration": 797.0779535770416, "error": null}
INFO:shared.analysis_manager:Completed analysis 7aadbdc7: success - 797.1s
INFO:asc842.clean_memo_generator:Prepended memo ID 7aadbdc7 to memo content
INFO:asc842.clean_memo_generator:Displaying clean memo sample: '**MEMO ID:** 7aadbdc7\n\n<small><em>Disclaimer Version: v1.0 (Effective 08/23/2025)</em></small><br>\n<small><em>This memorandum was generated by Veritas'
INFO:asc842.clean_memo_generator:Generating PDF using ReportLab
INFO:shared.pdf_generator:Generating PDF using ReportLab
INFO:shared.pdf_generator:PDF generation successful: 44993 bytes
INFO:asc842.clean_memo_generator:PDF generation successful: 44993 bytes