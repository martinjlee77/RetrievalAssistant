You reached the start of the range
Sep 26, 2025, 12:30 AM
Starting Container
Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.
  You can now view your Streamlit app in your browser.
  URL: http://0.0.0.0:8080
INFO:shared.preflight_pricing:Processing 1 uploaded files
INFO:shared.preflight_pricing:Processed file 1: gemini_sow.docx - 519 words
INFO:shared.preflight_pricing:Preflight pricing complete: 519 words, 3K (≤10 pages) tier, $95.0
INFO:shared.preflight_pricing:Processing 1 uploaded files
INFO:shared.preflight_pricing:Processed file 1: gemini_sow.docx - 519 words
INFO:shared.preflight_pricing:Preflight pricing complete: 519 words, 3K (≤10 pages) tier, $95.0
INFO:shared.api_cost_tracker:API cost tracker reset
INFO:shared.analysis_manager:ANALYSIS_EVENT: {"event_type": "start", "timestamp": "2025-09-26T04:32:23.059795", "analysis_id": "76d62c31", "asc_standard": "ASC 606", "total_words": 519, "file_count": 1, "tier": "3K (\u226410 pages)", "cost": 95.0, "user_id": 6, "status": "running", "success": null, "duration": null, "error": null}
INFO:shared.analysis_manager:Started analysis 76d62c31: ASC 606 - 519 words
INFO:shared.api_cost_tracker:API cost tracker reset
INFO:chromadb.telemetry.product.posthog:Anonymized telemetry enabled. See                     https://docs.trychroma.com/telemetry for more information.
INFO:shared.knowledge_base:ChromaDB client initialized for asc606_knowledge_base
INFO:shared.knowledge_base:Embedding function initialized successfully
INFO:shared.knowledge_base:Collection 'asc606_guidance' loaded successfully
INFO:asc606.knowledge_search:ASC 606 knowledge search initialized successfully
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o-mini, using default: 'Could not automatically map gpt-4o-mini to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o-mini, using default: 'Could not automatically map gpt-4o-mini to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-4o-mini, Input tokens: 829, Output tokens: 4, Cost: $0.0001
INFO:shared.api_cost_tracker:Tracked entity_extraction request: $0.0001 (Total: $0.0001)
INFO:__main__:LLM extracted customer: Global Dynamics Corp.
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO:shared.knowledge_base:Retrieved 8 relevant guidance chunks
INFO:asc606.knowledge_search:Retrieved guidance for Step 1
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-4o, Input tokens: 2470, Output tokens: 549, Cost: $0.0206
INFO:shared.api_cost_tracker:Tracked step_1_analysis request: $0.0206 (Total: $0.0207)
WARNING:asc606.step_analyzer:Step 1 validation issues: ["Currency potentially missing $ symbol: ['240,000', '50,000', '75,000', '30,000']"]
INFO:__main__:Completed ASC 606 Step 1
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO:shared.knowledge_base:Retrieved 8 relevant guidance chunks
INFO:asc606.knowledge_search:Retrieved guidance for Step 2
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-4o, Input tokens: 2802, Output tokens: 582, Cost: $0.0227
INFO:shared.api_cost_tracker:Tracked step_2_analysis request: $0.0227 (Total: $0.0435)
INFO:__main__:Completed ASC 606 Step 2
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO:shared.knowledge_base:Retrieved 8 relevant guidance chunks
INFO:asc606.knowledge_search:Retrieved guidance for Step 3
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-4o, Input tokens: 2472, Output tokens: 493, Cost: $0.0198
INFO:shared.api_cost_tracker:Tracked step_3_analysis request: $0.0198 (Total: $0.0632)
WARNING:asc606.step_analyzer:Step 3 validation issues: ["Currency potentially missing $ symbol: ['240,000', '720,000', '50,000', '75,000', '30,000', '875,000', '720,000', '50,000', '75,000', '30,000']"]
INFO:__main__:Completed ASC 606 Step 3
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO:shared.knowledge_base:Retrieved 8 relevant guidance chunks
INFO:asc606.knowledge_search:Retrieved guidance for Step 4
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-4o, Input tokens: 2257, Output tokens: 500, Cost: $0.0188
INFO:shared.api_cost_tracker:Tracked step_4_analysis request: $0.0188 (Total: $0.0820)
WARNING:asc606.step_analyzer:Step 4 validation issues: ["Currency potentially missing $ symbol: ['30,000']"]
INFO:__main__:Completed ASC 606 Step 4
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/embeddings "HTTP/1.1 200 OK"
INFO:shared.knowledge_base:Retrieved 8 relevant guidance chunks
INFO:asc606.knowledge_search:Retrieved guidance for Step 5
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
WARNING:shared.api_cost_tracker:Failed to get encoding for model gpt-4o, using default: 'Could not automatically map gpt-4o to a tokeniser. Please use `tiktok.get_encoding` to explicitly get the tokeniser you expect.'
INFO:shared.api_cost_tracker:API Cost - Model: gpt-4o, Input tokens: 2302, Output tokens: 597, Cost: $0.0205
INFO:shared.api_cost_tracker:Tracked step_5_analysis request: $0.0205 (Total: $0.1025)
WARNING:asc606.step_analyzer:Step 5 validation issues: ["Currency potentially missing $ symbol: ['240,000', '50,000', '30,000']"]
INFO:__main__:Completed ASC 606 Step 5
INFO:asc606.step_analyzer:Extracting conclusions from 5 steps
INFO:asc606.step_analyzer:Extracted conclusion for Step 1: Based on the analysis, a valid contract exists und...
INFO:asc606.step_analyzer:Extracted conclusion for Step 2: The contract contains three distinct performance o...
INFO:asc606.step_analyzer:Extracted conclusion for Step 3: The total transaction price is $875,000, comprisin...
INFO:asc606.step_analyzer:Extracted conclusion for Step 4: The transaction price will be allocated to the per...
INFO:asc606.step_analyzer:Extracted conclusion for Step 5: Revenue for the Logi-AI Suite SaaS license is reco...
INFO:asc606.step_analyzer:Total conclusions extracted: 5, text length: 1748
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:asc606.step_analyzer:Generated executive summary (1441 chars)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:asc606.step_analyzer:Generated background section (571 chars)
INFO:httpx:HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
INFO:asc606.clean_memo_generator:Added clean step 1 content (2547 chars)
INFO:asc606.clean_memo_generator:Added clean step 2 content (2838 chars)
INFO:asc606.clean_memo_generator:Added clean step 3 content (2466 chars)
INFO:asc606.clean_memo_generator:Added clean step 4 content (2676 chars)
INFO:asc606.clean_memo_generator:Added clean step 5 content (3044 chars)
INFO:asc606.clean_memo_generator:Clean memo generated: 24327 chars, 5/5 steps
ERROR:shared.analysis_manager:Database save failed - Status: 500
ERROR:shared.analysis_manager:Response headers: {'Date': 'Fri, 26 Sep 2025 04:33:36 GMT', 'Content-Type': 'application/json', 'Content-Length': '45', 'Connection': 'keep-alive', 'access-control-allow-credentials': 'true', 'access-control-allow-origin': 'http://127.0.0.1:3000', 'access-control-expose-headers': 'Authorization, Content-Type', 'Server': 'cloudflare', 'vary': 'Origin', 'x-railway-edge': 'railway/us-east4-eqdc4a', 'x-railway-request-id': '9woba-SfQbSLd7EgAax-fw', 'cf-cache-status': 'DYNAMIC', 'Nel': '{"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}', 'Report-To': '{"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=IoE6x7pnQBy3vnr9JNyFslNeFLGoCtQapS5NRsXb1xgdZtAr9naCsqq%2FhBlpKi4kQdRLCrM5Qy6zToRp6D2%2BkYWmroXaaCgXt7ZrTEyH2lcCf9A%3D"}]}', 'CF-RAY': '98500b4c4d7f574c-IAD', 'alt-svc': 'h3=":443"; ma=86400'}
ERROR:shared.analysis_manager:Response body: {
  "error": "Failed to complete analysis"
}
ERROR:shared.analysis_manager:Request URL: https://www.veritaslogic.ai/api/analysis/complete
ERROR:shared.analysis_manager:Request payload: {'asc_standard': 'ASC 606', 'words_count': 519, 'api_cost': 0.10245674999999999, 'file_count': 1, 'tier_name': '3K (≤10 pages)', 'is_free_analysis': False, 'idempotency_key': 'manager_76d62c31_1758861143059', 'started_at': '2025-09-26T04:32:23.059683', 'duration_seconds': 73.60194730758667}
ERROR:shared.analysis_manager:Parsed error response: {'error': 'Failed to complete analysis'}
INFO:shared.analysis_manager:ANALYSIS_EVENT: {"event_type": "complete", "timestamp": "2025-09-26T04:33:36.744548", "analysis_id": "76d62c31", "asc_standard": "ASC 606", "total_words": 519, "file_count": 1, "tier": "3K (\u226410 pages)", "cost": 95.0, "user_id": 6, "status": "completed", "success": true, "duration": 73.60194730758667, "error": null}
INFO:shared.analysis_manager:Completed analysis 76d62c31: success - 73.6s
INFO:asc606.clean_memo_generator:Displaying clean memo sample: '**MEMO ID:** 76d62c31\n\n<small><em>Disclaimer Version: v1.0 (Effective 08/23/2025)</em></small><br>\n<small><em>This memorandum was generated by Veritas'
INFO:asc606.clean_memo_generator:Removed PDF-related modules to prevent conflicts: ['pydyf']
INFO:asc606.clean_memo_generator:Importing WeasyPrint with clean module cache
WARNING:asc606.clean_memo_generator:PDF class patching failed: cannot import name 'pdf' from 'weasyprint.pdf' (/usr/local/lib/python3.11/site-packages/weasyprint/pdf/__init__.py)
INFO:asc606.clean_memo_generator:Creating HTML document
INFO:asc606.clean_memo_generator:Generating PDF from HTML
WARNING:weasyprint:Ignored `box-shadow: none ` at 37:25, unknown property.
WARNING:weasyprint:Ignored `box-shadow: 0 2px 4px rgba(0,0,0,0.1)` at 4:29, unknown property.
ERROR:asc606.clean_memo_generator:WeasyPrint PDF generation failed: PDF.__init__() takes 1 positional argument but 3 were given
WARNING:weasyprint:Ignored `box-shadow: none ` at 37:25, unknown property.
WARNING:weasyprint:Ignored `box-shadow: 0 2px 4px rgba(0,0,0,0.1)` at 4:29, unknown property.
ERROR:asc606.clean_memo_generator:PDF generation completely failed: PDF.__init__() takes 1 positional argument but 3 were given