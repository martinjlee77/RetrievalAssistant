<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - VeritasLogic.ai</title>
    
    <!-- SEO and Security -->
    <meta name="description" content="Manage your VeritasLogic account, track your usage, and access your ASC analysis tools.">
    <meta name="robots" content="noindex, nofollow">
    <link rel="canonical" href="https://veritaslogic.ai/dashboard.html">
    <meta name="referrer" content="no-referrer">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css?v=2025090702">
    <!-- Stripe JavaScript -->
    <script src="https://js.stripe.com/v3/"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="/" class="logo">VeritasLogic.ai</a>
            <ul class="nav-links">
                <li class="platform-nav-item">
                    <a href="/analysis" class="platform-nav-link" id="navPlatformLink" target="_blank">
                        <span class="nav-status-dot" id="navStatusDot"></span>
                        <span class="nav-platform-text">Analysis Platform</span>
                        <span class="nav-platform-status" id="navPlatformStatus">Checking...</span>
                    </a>
                </li>
                <li><a href="/">Home</a></li>
                <li><button onclick="logout()" class="btn btn-secondary btn-nav">Log Out</button></li>
            </ul>
        </div>
    </nav>

    <div class="dashboard-container pt-fixed-nav" id="dashboardContent">
        <!-- Dashboard Sidebar -->
        <div class="dashboard-sidebar hidden" id="dashboardSidebar">
            <div class="sidebar-header">
                <h3>Dashboard</h3>
            </div>
            <nav class="sidebar-nav">
                <a href="#overview" class="nav-item active" onclick="showSection('overview')">
                    <span class="nav-icon">üìä</span>
                    <span class="nav-text">Overview</span>
                </a>
                <a href="#credits" class="nav-item" onclick="showSection('credits')">
                    <span class="nav-icon">üí≥</span>
                    <span class="nav-text">Credits</span>
                </a>
                <a href="#profile" class="nav-item" onclick="showSection('profile')">
                    <span class="nav-icon">üë§</span>
                    <span class="nav-text">Profile</span>
                </a>
                <a href="#history" class="nav-item" onclick="showSection('history')">
                    <span class="nav-icon">üìà</span>
                    <span class="nav-text">History</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="/analysis" class="btn btn-primary" target="_blank">Launch Analysis</a>
            </div>
        </div>

        <!-- Dashboard Main Content -->
        <div class="dashboard-main hidden" id="dashboardMain">
        <!-- Loading state -->
        <div class="loading" id="loadingState">
            <p>Loading your dashboard...</p>
        </div>

        <!-- Inline Login Form -->
        <div id="loginSection" class="hidden">
            <div class="login-form-container">
                <div class="login-form">
                    <h2>üîê Sign In to Your Dashboard</h2>
                    <p>Enter your business email and password to access your account.</p>
                    
                    <div id="loginMessage" aria-live="polite"></div>
                    
                    <form id="dashboardLoginForm">
                        <div class="form-group">
                            <label for="loginEmail">Business Email Address</label>
                            <input type="email" id="loginEmail" name="email" placeholder="your.email@company.com" required autocomplete="email">
                        </div>
                        
                        <div class="form-group">
                            <label for="loginPassword">Password</label>
                            <input type="password" id="loginPassword" name="password" required autocomplete="current-password">
                        </div>
                        
                        <button type="submit" class="btn btn-primary" id="loginButton">
                            Sign In
                        </button>
                    </form>
                    
                    <div class="login-links">
                        <p>Don't have an account? <a href="signup.html">Create account with instant activation</a></p>
                        <p><a href="/">‚Üê Back to homepage</a></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Email Verification Required Section -->
        <div id="verificationSection" class="hidden">
            <div class="verification-container">
                <div class="verification-card">
                    <div class="verification-header">
                        <h2>üìß Please Verify Your Email Address</h2>
                        <p>To access your dashboard and start using VeritasLogic, please verify your email address.</p>
                    </div>
                    
                    <div class="verification-status">
                        <div class="email-display">
                            <span class="email-label">We sent a verification email to:</span>
                            <span class="email-address" id="verificationEmail">your-email@domain.com</span>
                        </div>
                        
                        <div class="verification-instructions">
                            <h3>üìã What to do next:</h3>
                            <ol>
                                <li><strong>Check your email inbox</strong> for a message from VeritasLogic</li>
                                <li><strong>Click the verification link</strong> in the email</li>
                                <li><strong>Return to this page</strong> - your dashboard will unlock automatically</li>
                            </ol>
                        </div>
                        
                        <div id="verificationMessage" aria-live="polite" class="verification-message"></div>
                        
                        <div class="verification-actions">
                            <button onclick="resendVerification()" class="btn btn-primary" id="resendBtn">
                                üìß Resend Verification Email
                            </button>
                            <button onclick="checkVerificationStatus()" class="btn btn-secondary" id="refreshBtn">
                                üîÑ I've Verified - Refresh Dashboard
                            </button>
                        </div>
                        
                        <div class="verification-help">
                            <h4>üí° Didn't receive the email?</h4>
                            <ul>
                                <li>Check your <strong>spam/junk folder</strong></li>
                                <li>Add <strong>support@veritaslogic.ai</strong> to your contacts</li>
                                <li>Wait a few minutes for delivery</li>
                                <li>Contact <a href="mailto:support@veritaslogic.ai">support@veritaslogic.ai</a> if you still need help</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main dashboard content -->
        <div id="mainContent" class="hidden">
            <div class="dashboard-header">
                <div class="welcome-section">
                    <h1>Welcome back, <span id="userName">User</span>!</h1>
                    <p id="memberSince">Member since</p>
                </div>
            </div>

            <!-- Overview Section -->
            <div id="overviewSection" class="dashboard-section active">
            
                <div class="dashboard-grid">
                    <!-- Account Balance Card -->
                    <div class="card balance-card">
                        <h2>üí≥ Account Balance</h2>
                        
                        <div class="credits-display" id="creditsDisplay">
                            <div class="number" id="creditsBalance">$0</div>
                            <div class="label">Account Credits Available</div>
                            <small class="credits-expiry">Credits expire 12 months from purchase.</small>
                        </div>
                        
                        <button onclick="showSection('credits')" class="btn btn-primary btn-full mt-lg">
                            üí≥ Add Credits
                        </button>
                    </div>
                    
                    <!-- Usage Stats Card -->
                    <div class="card stats-card">
                        <h2>üìà Usage Statistics</h2>
                        <div class="usage-stats">
                            <div class="stat-item">
                                <div class="stat-value" id="totalAnalyses">0</div>
                                <div class="stat-label">Total Analyses</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="thisMonth">0</div>
                                <div class="stat-label">This Month</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="totalSpent">$0</div>
                                <div class="stat-label">Total Spent</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Platform Status Card -->
                    <div class="card platform-status-card">
                        <h2>üåê Platform Status</h2>
                        <div class="platform-status">
                            <div class="status-item">
                                <div class="status-indicator" id="mainPlatformStatus">
                                    <span class="status-dot checking"></span>
                                    <span class="status-label">Main Platform</span>
                                </div>
                                <div class="status-value">Active</div>
                            </div>
                            <div class="status-item">
                                <div class="status-indicator" id="analysisPlatformStatus">
                                    <span class="status-dot checking"></span>
                                    <span class="status-label">Analysis Platform</span>
                                </div>
                                <div class="status-value" id="analysisPlatformValue">Checking...</div>
                            </div>
                            <div class="status-item">
                                <div class="status-indicator" id="databaseStatus">
                                    <span class="status-dot online"></span>
                                    <span class="status-label">Database</span>
                                </div>
                                <div class="status-value">Connected</div>
                            </div>
                        </div>
                        <div class="platform-actions">
                            <a href="/analysis" class="btn btn-primary platform-launch-btn" id="platformLaunchBtn">
                                üöÄ Launch Analysis Platform
                            </a>
                        </div>
                    </div>

                    <!-- Quick Actions Card -->
                    <div class="card actions-card">
                        <h2>‚ö° Quick Actions</h2>
                        <div class="action-buttons">
                            <button onclick="showSection('credits')" class="btn btn-secondary">üí≥ Add Credits</button>
                            <button onclick="showSection('history')" class="btn btn-secondary">üìà View History</button>
                            <button onclick="showSection('profile')" class="btn btn-secondary">üë§ Profile</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Credits Section -->
            <div id="creditsSection" class="dashboard-section">
                <div class="section-header">
                    <h2>üí≥ Manage Credits</h2>
                    <p>Add credits to your account to continue using our analysis platform.</p>
                    <p class="credits-policy"><strong>Credits expire 12 months from purchase</strong> and are automatically deducted per analysis based on document size. Payments are processed securely via Stripe.</p>
                </div>
            
                <div class="card credit-purchase-card">
                    <h3>üí≥ Credit Packages</h3>
                    <div class="credit-packages" id="creditPackages">
                        <!-- Credit packages will be loaded here -->
                        <div class="loading-packages">Loading packages...</div>
                    </div>
                    
                    <h3>‚úèÔ∏è Custom Amount</h3>
                    <div class="custom-amount-section">
                        <div class="custom-amount-input">
                            <label for="customAmount">Enter amount ($95 - $3,000):</label>
                            <div class="amount-input-group">
                                <span class="currency-symbol">$</span>
                                <input type="number" id="customAmount" min="195" max="3000" step="1" placeholder="1000">
                                <button onclick="selectCustomAmount()" class="btn btn-secondary">Select</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="payment-form-container hidden" id="paymentFormContainer">
                        <h3>Payment Details</h3>
                        <div class="selected-package" id="selectedPackageDisplay"></div>
                        
                        <form id="payment-form">
                            <div id="card-element">
                                <!-- Stripe card element will be inserted here -->
                            </div>
                            <div id="card-errors" role="alert"></div>
                            
                            <button type="submit" id="submit-payment" class="btn btn-primary payment-btn">
                                <span id="button-text">Complete Payment</span>
                            </button>
                        </form>
                        
                        <button onclick="cancelPayment()" class="btn btn-secondary">Cancel</button>
                    </div>
                    
                    <div id="payment-messages" aria-live="polite"></div>
                </div>
            </div>

            <!-- Profile Section -->
            <div id="profileSection" class="dashboard-section">
                <div class="section-header">
                    <h2>üë§ Profile Information</h2>
                    <p>Manage your account settings and security.</p>
                </div>
            
                <div class="profile-grid">
                    <div class="card profile-info-card">
                        <h3>üìß Account Information</h3>
                        <div class="profile-fields">
                            <div class="profile-field">
                                <span class="field-label">First Name:</span>
                                <span class="field-value" id="userFirstName">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="field-label">Last Name:</span>
                                <span class="field-value" id="userLastName">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="field-label">Email:</span>
                                <span class="field-value" id="userEmail">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="field-label">Company:</span>
                                <span class="field-value" id="userCompany">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="field-label">Member Since:</span>
                                <span class="field-value" id="memberSinceDate">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="field-label">Account Status:</span>
                                <span class="field-value" id="accountStatus">Active</span>
                            </div>
                        </div>
                        
                        <!-- Edit Profile Section -->
                        <div class="edit-profile-section">
                            <h4>‚úèÔ∏è Edit Name</h4>
                            <div id="editProfileMessage" aria-live="polite"></div>
                            <form id="editProfileForm" class="mt-md" onsubmit="submitProfileUpdate(event)">
                                <div class="form-group">
                                    <label for="editFirstName">First Name</label>
                                    <input type="text" id="editFirstName" name="firstName" required placeholder="Enter your first name" autocomplete="given-name">
                                </div>
                                
                                <div class="form-group">
                                    <label for="editLastName">Last Name</label>
                                    <input type="text" id="editLastName" name="lastName" required placeholder="Enter your last name" autocomplete="family-name">
                                </div>
                                
                                <button type="submit" class="btn btn-primary" id="updateProfileButton">
                                    Update Name
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="card password-card">
                
                        <h3>üîê Change Password</h3>
                    <div id="changePasswordMessage" aria-live="polite"></div>
                    <form id="changePasswordForm" class="mt-md">
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" name="currentPassword" required placeholder="Enter your current password" autocomplete="current-password">
                        </div>
                        
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <div class="password-wrapper">
                                <input type="password" id="newPassword" name="newPassword" required placeholder="Enter your new password" autocomplete="new-password">
                                <div class="password-helper">
                                    <span class="password-helper-icon">?</span>
                                    <div class="password-tooltip">
                                        <small>Password must contain at least:</small>
                                        <ul>
                                            <li id="req-length">8 characters</li>
                                            <li id="req-uppercase">One uppercase letter</li>
                                            <li id="req-lowercase">One lowercase letter</li>
                                            <li id="req-number">One number</li>
                                            <li id="req-special">One special character</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="confirmNewPassword">Confirm New Password</label>
                            <input type="password" id="confirmNewPassword" name="confirmNewPassword" required placeholder="Confirm your new password" autocomplete="new-password">
                            <div id="password-match" class="password-feedback"></div>
                        </div>
                        
                        <button type="submit" class="btn btn-primary" id="changePasswordButton">
                            Update Password
                        </button>
                        </form>
                    </div>
                </div>
            </div>


            <!-- History Section -->
            <div id="historySection" class="dashboard-section">
                <div class="section-header">
                    <h2>üìà Analysis History</h2>
                    <p>View your recent analyses and download reports.</p>
                </div>
                
                <div class="card history-card">
                    <div id="recentAnalysesList" class="recent-analyses">
                        <div class="empty-state">
                            <div>üìÑ</div>
                            <p>No analyses yet. Ready to get started?</p>
                            <a href="/analysis" class="btn btn-primary" target="_blank">Start Your First Analysis</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </div>

    <script src="dashboard.js" defer></script>
    
</html>